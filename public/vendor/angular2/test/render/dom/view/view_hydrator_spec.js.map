{"version":3,"sources":["view_hydrator_spec.es6"],"names":[],"mappings":"AAAA,KAAK,SAAS,AAAC,keAAoB,UAAS,SAAQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2B7C,SAAS,KAAG,CAAE,AAAD;AAClB,WAAO,AAAC,CAAC,oBAAmB,GAAG,SAAC,AAAD;AAC7B,AAAI,QAAA,CAAA,iBAAgB,CAAC;AACrB,AAAI,QAAA,CAAA,YAAW,CAAC;AAChB,AAAI,QAAA,CAAA,WAAU,CAAC;AACf,AAAI,QAAA,CAAA,YAAW,CAAC;AAChB,aAAS,gBAAc,CAAE,AACX;4DAAD,GAAC;AADY,iBAAK;AAC7B,kBAAM;AACN,WAAI,OAAM,AAAC,CAAC,MAAK,CAAC,CAAG;AACnB,eAAK,EAAI,CAAA,EAAC,AAAC,CAAC,aAAY,CAAC,CAAC;QAC5B;AAAA,AACA,WAAI,OAAM,AAAC,CAAC,OAAM,CAAC,CAAG;AACpB,gBAAM,EAAI,GAAC,CAAC;QACd;AAAA,AACA,aAAO,IAAI,gBAAc,AAAC,CAAC;AACzB,gBAAM,CAAG,OAAK;AACd,uBAAa,CAAG,QAAM;AAAA,QACxB,CAAC,CAAC;MACJ;AACA,aAAS,wBAAsB,CAAE,WAAU,AAAwB,CAAG;UAAxB,gBAAc,6CAAI,KAAG;AACjE,AAAI,UAAA,CAAA,MAAK,EAAI,IAAI,cAAY,AAAC,CAAC;AAC7B,oBAAU,CAAG,YAAU;AACvB,wBAAc,CAAG,GAAC;AAAA,QACpB,CAAC,CAAC;AACF,aAAK,gBAAgB,EAAI,gBAAc,CAAC;AACxC,aAAO,OAAK,CAAC;MACf;AAAA,AACA,aAAS,oBAAkB,CAAE,eAAc,CAAG;AAC5C,aAAO,CAAA,eAAc,AAAC,CAAC,CAAC,OAAM,CAAG,EAAC,uBAAsB,AAAC,CAAC,eAAc,CAAG,gBAAc,CAAC,CAAC,CAAC,CAAC,CAAC;MAChG;AAAA,AACA,aAAS,gBAAc,CAAE,AAAD,CAAG;AACzB,AAAI,UAAA,CAAA,IAAG,EAAI,CAAA,EAAC,AAAC,CAAC,wBAAuB,CAAC,CAAC;AACvC,aAAO,IAAI,WAAS,AAAC,CAAC,eAAc,AAAC,EAAC,CAAG,EAAC,GAAE,WAAW,AAAC,CAAC,IAAG,CAAC,CAAE,CAAA,CAAC,CAAC,CAAG,GAAC,CAAG,GAAC,CAAG,GAAC,CAAC,CAAC;MACjF;AAAA,AACA,aAAS,eAAa,CAAE,EAAC,CAAG,CAAA,aAAY,CAAG;AACzC,AAAI,UAAA,CAAA,IAAG,EAAI,IAAI,WAAS,AAAC,CAAC,EAAC,CAAG,EAAC,EAAC,AAAC,CAAC,aAAY,CAAC,CAAC,CAAG,GAAC,CAAG,EAAC,EAAC,AAAC,CAAC,aAAY,CAAC,CAAC,CAAG,EAAC,IAAG,CAAC,CAAC,CAAC;AACnF,kBAAU,iBAAiB,AAAC,CAAC,IAAG,CAAG,EAAA,CAAG,cAAY,CAAC,CAAC;AACpD,aAAO,KAAG,CAAC;MACb;AAAA,AACA,aAAS,QAAM,CAAE,IAAG,CAAG;AACrB,mBAAW,uBAAuB,AAAC,CAAC,IAAG,CAAG,KAAG,CAAC,CAAC;MACjD;AAAA,AACA,aAAS,UAAQ,CAAE,IAAG,CAAG;AACvB,mBAAW,yBAAyB,AAAC,CAAC,IAAG,CAAG,KAAG,CAAC,CAAC;MACnD;AAAA,AACA,eAAS,AAAC,EAAC,SAAC,AAAD;AACT,mBAAW,EAAI,IAAI,gBAAc,AAAC,EAAC,CAAC;AACpC,wBAAgB,EAAI,IAAI,qBAAmB,AAAC,EAAC,CAAC;AAC9C,wBAAgB,IAAI,AAAC,CAAC,mBAAkB,CAAC,YAAY,AAAC,EAAC,SAAC,YAAW,CAAG,CAAA,aAAY,CAAG,CAAA,EAAC,CAAM;AAC1F,eAAO,IAAI,YAAU,AAAC,EAAC,CAAC;QAC1B,EAAC,CAAC;AACF,kBAAU,EAAI,IAAI,YAAU,AAAC,CAAC,CAAA,CAAG,aAAW,CAAG,kBAAgB,CAAC,CAAC;AACjE,mBAAW,EAAI,IAAI,mBAAiB,AAAC,CAAC,YAAW,CAAG,YAAU,CAAC,CAAC;MAClE,EAAC,CAAC;AACF,aAAO,AAAC,CAAC,6BAA4B,GAAG,SAAC,AAAD;AACtC,SAAC,AAAC,CAAC,qBAAoB,GAAG,SAAC,AAAD,CAAM;AAC9B,AAAI,YAAA,CAAA,UAAS,EAAI,CAAA,eAAc,AAAC,EAAC,CAAC;AAClC,AAAI,YAAA,CAAA,MAAK,EAAI,CAAA,mBAAkB,AAAC,CAAC,eAAc,AAAC,EAAC,CAAC,CAAC;AACnD,AAAI,YAAA,CAAA,QAAO,EAAI,CAAA,cAAa,AAAC,CAAC,MAAK,CAAG,WAAS,CAAC,CAAC;AACjD,qBAAW,4BAA4B,AAAC,CAAC,QAAO,CAAG,EAAA,CAAG,WAAS,CAAC,CAAC;AACjE,AAAI,YAAA,CAAA,WAAU,EAAI,CAAA,MAAK,KAAK,AAAC,CAAC,QAAO,UAAU,CAAE,CAAA,CAAC,CAAG,YAAU,CAAC,CAAC;AACjE,eAAK,AAAC,CAAC,WAAU,IAAI,AAAC,CAAC,cAAa,CAAC,CAAC,iBAAiB,AAAC,EAAC,CAAC;QAC5D,EAAC,CAAC;MACJ,EAAC,CAAC;AACF,aAAO,AAAC,CAAC,iCAAgC,GAAG,SAAC,AAAD;AAC1C,SAAC,AAAC,CAAC,0CAAyC,GAAG,SAAC,AAAD,CAAM;AACnD,AAAI,YAAA,CAAA,MAAK,EAAI,CAAA,mBAAkB,AAAC,CAAC,eAAc,AAAC,EAAC,CAAC,CAAC;AACnD,AAAI,YAAA,CAAA,UAAS,EAAI,CAAA,eAAc,AAAC,EAAC,CAAC;AAClC,uBAAa,AAAC,CAAC,MAAK,CAAG,WAAS,CAAC,CAAC;AAClC,gBAAM,AAAC,CAAC,UAAS,CAAC,CAAC;AACnB,eAAK,AAAC,CAAC,UAAS,SAAS,CAAC,KAAK,AAAC,CAAC,IAAG,CAAC,CAAC;QACxC,EAAC,CAAC;MACJ,EAAC,CAAC;AACF,aAAO,AAAC,CAAC,mCAAkC,GAAG,SAAC,AAAD;AAC5C,AAAI,UAAA,CAAA,QAAO,CAAC;AACZ,eAAS,iBAAe,CAAE,eAAc,CAAG,CAAA,UAAS,CAAG;AACrD,AAAI,YAAA,CAAA,MAAK,EAAI,CAAA,mBAAkB,AAAC,CAAC,eAAc,CAAC,CAAC;AACjD,iBAAO,EAAI,CAAA,cAAa,AAAC,CAAC,MAAK,CAAG,WAAS,CAAC,CAAC;AAC7C,gBAAM,AAAC,CAAC,QAAO,CAAC,CAAC;QACnB;AAAA,AACA,SAAC,AAAC,CAAC,mCAAkC,GAAG,SAAC,AAAD,CAAM;AAC5C,AAAI,YAAA,CAAA,UAAS,EAAI,CAAA,eAAc,AAAC,EAAC,CAAC;AAClC,yBAAe,AAAC,CAAC,eAAc,AAAC,EAAC,CAAG,WAAS,CAAC,CAAC;AAC/C,eAAK,AAAC,CAAC,UAAS,SAAS,CAAC,KAAK,AAAC,CAAC,IAAG,CAAC,CAAC;AACtC,kBAAQ,AAAC,CAAC,QAAO,CAAC,CAAC;AACnB,eAAK,AAAC,CAAC,UAAS,SAAS,CAAC,KAAK,AAAC,CAAC,KAAI,CAAC,CAAC;QACzC,EAAC,CAAC;AACF,SAAC,AAAC,CAAC,0CAAyC,GAAG,SAAC,AAAD,CAAM;AACnD,AAAI,YAAA,CAAA,UAAS,EAAI,CAAA,eAAc,AAAC,EAAC,CAAC;AAClC,yBAAe,AAAC,CAAC,eAAc,AAAC,EAAC,CAAG,WAAS,CAAC,CAAC;AAC/C,kBAAQ,AAAC,CAAC,QAAO,CAAC,CAAC;AACnB,eAAK,AAAC,CAAC,QAAO,oBAAoB,CAAE,CAAA,CAAC,CAAC,KAAK,AAAC,CAAC,UAAS,CAAC,CAAC;AACxD,eAAK,AAAC,CAAC,UAAS,UAAU,CAAE,CAAA,CAAC,WAAW,CAAC,WAAW,AAAC,EAAC,CAAC;QACzD,EAAC,CAAC;AACF,SAAC,AAAC,CAAC,uCAAsC,GAAG,SAAC,AAAD,CAAM;AAChD,AAAI,YAAA,CAAA,UAAS,EAAI,CAAA,eAAc,AAAC,EAAC,CAAC;AAClC,yBAAe,AAAC,CAAC,IAAG,CAAG,WAAS,CAAC,CAAC;AAClC,kBAAQ,AAAC,CAAC,QAAO,CAAC,CAAC;AACnB,eAAK,AAAC,CAAC,QAAO,oBAAoB,CAAE,CAAA,CAAC,CAAC,KAAK,AAAC,CAAC,IAAG,CAAC,CAAC;AAClD,eAAK,AAAC,CAAC,UAAS,UAAU,CAAE,CAAA,CAAC,WAAW,CAAC,KAAK,AAAC,CAAC,IAAG,CAAC,CAAC;QACvD,EAAC,CAAC;MACJ,EAAC,CAAC;IACJ,EAAC,CAAC;EACJ;AAjIQ,UAAQ,AAAC,cAAqC,CAAA;AADtD,OAAO;AACD,UAAM,GADZ,SAAS,IAAG,CAAG;AAAf,aAAoB,KAAG,OAAkB,CAAC;IAElC,CAFR,UAAS,IAAG;AAAZ,yBAAoB,KAAG,mBAAkB,CAAC;AAA1C,iBAAoB,KAAG,WAAkB,CAAC;AAA1C,gBAAoB,KAAG,UAAkB,CAAC;AAA1C,gBAAoB,KAAG,UAAkB,CAAC;AAA1C,eAAoB,KAAG,SAAkB,CAAC;AAA1C,SAAoB,KAAG,GAAkB,CAAC;AAA1C,oBAAoB,KAAG,cAAkB,CAAC;AAA1C,aAAoB,KAAG,OAAkB,CAAC;AAA1C,UAAoB,KAAG,IAAkB,CAAC;AAA1C,aAAoB,KAAG,OAAkB,CAAC;AAA1C,yBAAoB,KAAG,mBAAkB,CAAC;AAA1C,SAAoB,KAAG,GAAkB,CAAC;AAA1C,UAAoB,KAAG,IAAkB,CAAC;AAA1C,gBAAoB,KAAG,UAAkB,CAAC;AAA1C,YAAoB,KAAG,MAAkB,CAAC;IAElC,CAFR,UAAS,IAAG;AAAZ,iBAAoB,KAAG,WAAkB,CAAC;AAA1C,cAAoB,KAAG,QAAkB,CAAC;IAElC,CAFR,UAAS,IAAG,CAAG;AAAf,sBAAoB,KAAG,gBAAkB,CAAC;IAElC,CAFR,UAAS,IAAG,CAAG;AAAf,oBAAoB,KAAG,cAAkB,CAAC;IAElC,CAFR,UAAS,IAAG,CAAG;AAAf,iBAAoB,KAAG,WAAkB,CAAC;IAElC,CAFR,UAAS,IAAG,CAAG;AAAf,wBAAoB,KAAG,kBAAkB,CAAC;IAElC,CAFR,UAAS,IAAG,CAAG;AAAf,eAAoB,KAAG,SAAkB,CAAC;IAElC,CAFR,UAAS,IAAG,CAAG;AAAf,mBAAoB,KAAG,aAAkB,CAAC;IAElC,CAFR,UAAS,IAAG,CAAG;AAAf,UAAoB,KAAG,IAAkB,CAAC;IAElC,CAFR,UAAS,IAAG,CAAG;AAAf,kBAAoB,KAAG,YAAkB,CAAC;IAElC,CAFR,UAAS,IAAG,CAAG;AAAf,yBAAoB,KAAG,mBAAkB,CAAC;IAElC,CADuB;AACzB,UAAM;AAFZ,wBAAA,SAAS,QAAO;AACN,AAAI,UAAA,kBAkId,SAAM,gBAAc,CACN,AAAD,CAAG;AACZ,AArIJ,wBAAc,iBAAiB,AAAC,iBAAkB,KAAK,MAqI7C,aAAW,CArIqD,CAqInD;QACrB,AArIgD,CAAC;AACzC,aAAO,CAAA,CAAC,eAAc,YAAY,CAAC,AAAC,mBAqI5C,YAAW,CAAX,UAAa,CAAA,CAAG;AACd,iBAxIJ,CAAA,eAAc,SAAS,AAAC,iDAAwD,KAA3D,MAwIS,EAAA,CAxIU,CAwIR;UAC9B,MAtIgE,SAAO,CAAC,CAAC;MACnE,AAAC,CA+HqB,SAAQ,CA/HX,CAJS,CAAA;AA2IpC,WAAK,eAAe,AAAC,CAAC,eAAc,CAAG,cAAY,CAAG,EAAC,GAAE,CAAG,UAAS,AAAD,CAAG;AACnE,eAAO,EAAC,GAAI,MAAI,CAAG,IAAI,WAAS,AAAC,CAAC,YAAW,CAAC,CAAC,CAAC;QAClD,CAAC,CAAC,CAAC;AA7IL,6BAAA,SAAS,QAAO;AACN,AAAI,UAAA,uBA6Id,SAAM,qBAAmB,CACX,AAAD,CAAG;AACZ,AAhJJ,wBAAc,iBAAiB,AAAC,sBAAkB,KAAK,MAgJ7C,kBAAgB,CAhJgD,CAgJ9C;QAC1B,AAhJgD,CAAC;AACzC,aAAO,CAAA,CAAC,eAAc,YAAY,CAAC,AAAC,wBAgJ5C,YAAW,CAAX,UAAa,CAAA,CAAG;AACd,iBAnJJ,CAAA,eAAc,SAAS,AAAC,sDAAwD,KAA3D,MAmJS,EAAA,CAnJU,CAmJR;UAC9B,MAjJgE,SAAO,CAAC,CAAC;MACnE,AAAC,CA0I0B,SAAQ,CA1IhB,CAJS,CAAA;AAsJpC,WAAK,eAAe,AAAC,CAAC,oBAAmB,CAAG,cAAY,CAAG,EAAC,GAAE,CAAG,UAAS,AAAD,CAAG;AACxE,eAAO,EAAC,GAAI,MAAI,CAAG,IAAI,WAAS,AAAC,CAAC,iBAAgB,CAAC,CAAC,CAAC;QACvD,CAAC,CAAC,CAAC;AAxJL,oBAAA,SAAS,QAAO;AACN,AAAI,UAAA,cAwJd,SAAM,YAAU,CACF,AAAD,CAAG;AACZ,AA3JJ,wBAAc,iBAAiB,AAAC,aAAkB,KAAK,MA2J7C,SAAO,CA3JyD,CA2JvD;QACjB,AA3JgD,CAAC;AACzC,aAAO,CAAA,CAAC,eAAc,YAAY,CAAC,AAAC,eA2J5C,YAAW,CAAX,UAAa,CAAA,CAAG;AACd,iBA9JJ,CAAA,eAAc,SAAS,AAAC,6CAAwD,KAA3D,MA8JS,EAAA,CA9JU,CA8JR;UAC9B,MA5JgE,SAAO,CAAC,CAAC;MACnE,AAAC,CAqJiB,SAAQ,CArJP,CAJS,CAAA;AAiKpC,WAAK,eAAe,AAAC,CAAC,WAAU,CAAG,cAAY,CAAG,EAAC,GAAE,CAAG,UAAS,AAAD,CAAG;AAC/D,eAAO,EAAC,GAAI,MAAI,CAAG,IAAI,WAAS,AAAC,CAAC,QAAO,CAAC,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;IAjK0B;EAC3B,CAAA;AADI,CAAC,CAAC;AAoKkC","file":"angular2/test/render/dom/view/view_hydrator_spec.js","sourcesContent":["import {assert} from \"rtts_assert/rtts_assert\";\nimport {AsyncTestCompleter,\n  beforeEach,\n  ddescribe,\n  xdescribe,\n  describe,\n  el,\n  dispatchEvent,\n  expect,\n  iit,\n  inject,\n  beforeEachBindings,\n  it,\n  xit,\n  SpyObject,\n  proxy} from 'angular2/test_lib';\nimport {IMPLEMENTS,\n  isBlank} from 'angular2/src/facade/lang';\nimport {RenderProtoView} from 'angular2/src/render/dom/view/proto_view';\nimport {ElementBinder} from 'angular2/src/render/dom/view/element_binder';\nimport {RenderView} from 'angular2/src/render/dom/view/view';\nimport {ShadowDomStrategy} from 'angular2/src/render/dom/shadow_dom/shadow_dom_strategy';\nimport {LightDom} from 'angular2/src/render/dom/shadow_dom/light_dom';\nimport {EventManager} from 'angular2/src/render/dom/events/event_manager';\nimport {DOM} from 'angular2/src/dom/dom_adapter';\nimport {ViewFactory} from 'angular2/src/render/dom/view/view_factory';\nimport {RenderViewHydrator} from 'angular2/src/render/dom/view/view_hydrator';\nexport function main() {\n  describe('RenderViewHydrator', () => {\n    var shadowDomStrategy;\n    var eventManager;\n    var viewFactory;\n    var viewHydrator;\n    function createProtoView({rootEl,\n      binders} = {}) {\n      if (isBlank(rootEl)) {\n        rootEl = el('<div></div>');\n      }\n      if (isBlank(binders)) {\n        binders = [];\n      }\n      return new RenderProtoView({\n        element: rootEl,\n        elementBinders: binders\n      });\n    }\n    function createComponentElBinder(componentId, nestedProtoView = null) {\n      var binder = new ElementBinder({\n        componentId: componentId,\n        textNodeIndices: []\n      });\n      binder.nestedProtoView = nestedProtoView;\n      return binder;\n    }\n    function createHostProtoView(nestedProtoView) {\n      return createProtoView({binders: [createComponentElBinder('someComponent', nestedProtoView)]});\n    }\n    function createEmptyView() {\n      var root = el('<div><div></div></div>');\n      return new RenderView(createProtoView(), [DOM.childNodes(root)[0]], [], [], []);\n    }\n    function createHostView(pv, shadowDomView) {\n      var view = new RenderView(pv, [el('<div></div>')], [], [el('<div></div>')], [null]);\n      viewFactory.setComponentView(view, 0, shadowDomView);\n      return view;\n    }\n    function hydrate(view) {\n      viewHydrator.hydrateInPlaceHostView(null, view);\n    }\n    function dehydrate(view) {\n      viewHydrator.dehydrateInPlaceHostView(null, view);\n    }\n    beforeEach(() => {\n      eventManager = new SpyEventManager();\n      shadowDomStrategy = new SpyShadowDomStrategy();\n      shadowDomStrategy.spy('constructLightDom').andCallFake((lightDomView, shadowDomView, el) => {\n        return new SpyLightDom();\n      });\n      viewFactory = new ViewFactory(1, eventManager, shadowDomStrategy);\n      viewHydrator = new RenderViewHydrator(eventManager, viewFactory);\n    });\n    describe('hydrateDynamicComponentView', () => {\n      it('should redistribute', () => {\n        var shadowView = createEmptyView();\n        var hostPv = createHostProtoView(createProtoView());\n        var hostView = createHostView(hostPv, shadowView);\n        viewHydrator.hydrateDynamicComponentView(hostView, 0, shadowView);\n        var lightDomSpy = assert.type(hostView.lightDoms[0], SpyLightDom);\n        expect(lightDomSpy.spy('redistribute')).toHaveBeenCalled();\n      });\n    });\n    describe('hydrate... shared functionality', () => {\n      it('should hydrate existing child components', () => {\n        var hostPv = createHostProtoView(createProtoView());\n        var shadowView = createEmptyView();\n        createHostView(hostPv, shadowView);\n        hydrate(shadowView);\n        expect(shadowView.hydrated).toBe(true);\n      });\n    });\n    describe('dehydrate... shared functionality', () => {\n      var hostView;\n      function createAndHydrate(nestedProtoView, shadowView) {\n        var hostPv = createHostProtoView(nestedProtoView);\n        hostView = createHostView(hostPv, shadowView);\n        hydrate(hostView);\n      }\n      it('should dehydrate child components', () => {\n        var shadowView = createEmptyView();\n        createAndHydrate(createProtoView(), shadowView);\n        expect(shadowView.hydrated).toBe(true);\n        dehydrate(hostView);\n        expect(shadowView.hydrated).toBe(false);\n      });\n      it('should not clear static child components', () => {\n        var shadowView = createEmptyView();\n        createAndHydrate(createProtoView(), shadowView);\n        dehydrate(hostView);\n        expect(hostView.componentChildViews[0]).toBe(shadowView);\n        expect(shadowView.rootNodes[0].parentNode).toBeTruthy();\n      });\n      it('should clear dynamic child components', () => {\n        var shadowView = createEmptyView();\n        createAndHydrate(null, shadowView);\n        dehydrate(hostView);\n        expect(hostView.componentChildViews[0]).toBe(null);\n        expect(shadowView.rootNodes[0].parentNode).toBe(null);\n      });\n    });\n  });\n}\nclass SpyEventManager extends SpyObject {\n  constructor() {\n    super(EventManager);\n  }\n  noSuchMethod(m) {\n    return super.noSuchMethod(m);\n  }\n}\nObject.defineProperty(SpyEventManager, \"annotations\", {get: function() {\n    return [new proxy, new IMPLEMENTS(EventManager)];\n  }});\nclass SpyShadowDomStrategy extends SpyObject {\n  constructor() {\n    super(ShadowDomStrategy);\n  }\n  noSuchMethod(m) {\n    return super.noSuchMethod(m);\n  }\n}\nObject.defineProperty(SpyShadowDomStrategy, \"annotations\", {get: function() {\n    return [new proxy, new IMPLEMENTS(ShadowDomStrategy)];\n  }});\nclass SpyLightDom extends SpyObject {\n  constructor() {\n    super(LightDom);\n  }\n  noSuchMethod(m) {\n    return super.noSuchMethod(m);\n  }\n}\nObject.defineProperty(SpyLightDom, \"annotations\", {get: function() {\n    return [new proxy, new IMPLEMENTS(LightDom)];\n  }});\n//# sourceMappingURL=view_hydrator_spec.js.map\n\n//# sourceMappingURL=./view_hydrator_spec.map"]}